import * as vscode from "vscode";
import * as fs from "fs";

export default function openTestFile(sourceFilePath: string) {
  if (sourceFilePath.indexOf(".test.") > -1) return;

  let testFilePath: string;
  if (sourceFilePath.endsWith(".js")) {
    testFilePath = `${sourceFilePath.slice(0, -3)}.test.js`;
  } else if (sourceFilePath.endsWith(".jsx")) {
    testFilePath = `${sourceFilePath.slice(0, -4)}.test.jsx`;
  } else if (sourceFilePath.endsWith(".ts")) {
    testFilePath = `${sourceFilePath.slice(0, -3)}.test.ts`;
  } else if (sourceFilePath.endsWith(".tsx")) {
    testFilePath = `${sourceFilePath.slice(0, -4)}.test.tsx`;
  } else if (sourceFilePath.endsWith(".mjs")) {
    testFilePath = `${sourceFilePath.slice(0, -4)}.test.mjs`;
  } else {
    return;
  }
  const finalTestFilePath = testFilePath.replace("src", "testing");
  if (!fs.existsSync(finalTestFilePath)) {
    return;
  }

  vscode.workspace.openTextDocument(finalTestFilePath).then((doc) => {
    vscode.window.showTextDocument(doc);
  });
}
